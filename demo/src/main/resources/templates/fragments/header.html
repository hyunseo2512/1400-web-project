<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<div th:fragment="header">
    <nav class="sb-topnav navbar navbar-expand navbar-dark bg-dark">

        <a class="navbar-brand ps-3 d-flex align-items-center" th:href="@{/}">
            <svg width="24" height="24" viewBox="0 0 32 32" class="me-2">
                <rect x="4" y="6" width="24" height="18" rx="4" fill="#4A90E2"/>
                <path d="M 10 24 L 8 28 L 12 24 Z" fill="#4A90E2"/>
                <circle cx="12" cy="15" r="2" fill="white"/>
                <circle cx="20" cy="15" r="2" fill="white"/>
                <path d="M 12 18 Q 16 20 20 18" stroke="white" stroke-width="1.5" fill="none"/>
            </svg>
            <span>Community</span>
        </a>

        <button class="btn btn-link btn-sm order-1 order-lg-0 me-4 me-lg-0" id="sidebarToggle" href="#!">
            <i class="fas fa-bars"></i>
        </button>

        <form class="d-none d-md-inline-block form-inline ms-auto me-0 me-md-3 my-2 my-md-0" role="search">
            <div class="input-group">
                <input class="form-control" type="search" placeholder="Search for..." aria-label="Search" />
                <button class="btn btn-primary" type="submit">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </form>

        <ul class="navbar-nav ms-auto ms-md-0 me-3 me-lg-4">
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a class="nav-link" th:href="@{/user/login}">Login</a>
            </li>
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a class="nav-link" th:href="@{/user/join}">SignUp</a>
            </li>

            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link" th:href="@{/}"><i class="bi bi-chat-dots"></i></a>
            </li>
            <li class="nav-item" sec:authorize="isAuthenticated()">
                <a class="nav-link" th:href="@{/}"><i class="bi bi-bell"></i></a>
            </li>

            <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                <a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fas fa-user fa-fw"></i> <span th:text="${#authentication.name}">User</span>
                </a>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                    <li><a class="dropdown-item" th:href="@{/user/modify}">Profile Settings</a></li>
                    <li sec:authorize="hasAnyAuthority('ROLE_ADMIN')"><a class="dropdown-item" th:href="@{/user/list}">User List</a></li>
                    <li><hr class="dropdown-divider" /></li>
                    <li>
                        <a class="dropdown-item" id="logout" href="#!">Logout</a>
                        <form action="/user/logout" method="post" id="logoutForm" style="display:none;"></form>
                    </li>
                </ul>
            </li>
        </ul>
    </nav>

    <script>
        // 로그아웃 스크립트
        document.getElementById("logout")?.addEventListener('click',(e)=>{
            e.preventDefault();
            document.getElementById('logoutForm').submit();
        });
    </script>
</div>
</html>